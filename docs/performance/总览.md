首屏速度优化



## 请求耗时

### 建立连接耗时

DNS域名解析优化：DNS缓存

TCP连接：

SSL握手：HTTP2 SSL交换密钥耗时  采用TLS1.3 代替 TLS1.2

1. 握手过程：TLS1.3 把 **Hello** 和 **公钥交换** 两个消息合并成一个消息，从 4次握手2个RTT，减少到 2次握手1个RTT 就可以完成TLS握手。
2. 密钥交换算法：用 ECDHE 算法 替换RSA算法（速度慢，安全性不高）

### 请求资源耗时

使用CDN：使用内容分发网络（CDN）可以将静态资源缓存到离用户更近的边缘节点，减少网络延迟和握手延迟

启用HTTP缓存：强缓存 协商缓存

减少HTTP请求数量：精灵图，小于5kb的图片用base64打包到代码中

```html
{
	loader: 'url-loader',
  options: {
      limit: 5 * 1024,
      outputPath: '/img1/',
  }
}
```

采用HTTP2：利用多路复用

减小包体积：

代码分割，公共代码提取到一个chunk，避免重复加载

代码分割，按需加载

缓存优化，把不常变动的模块打包成一个chunk，利用缓存机制

压缩包体积：

1. uglify-js压缩JS体积，webpack optimization.minimizer 默认采用 TerserPlugin 进行JS代码压缩，用户可自定义配置来覆盖原有的 TerserPlugin 
2. MiniCssExtractPlugin 压缩CSS体积
3. Gzip压缩

Tree-shaking：原理，收集模块导出，标记未使用过的模块导出，生成代码，再由 Terser 删除Dead Code。



只说优化手段，不说原理，八股文一问就寄。比如雪碧图是为了解决HTTP1.0时代TCP复用问题，在后续HTTP升级后会造成请求不必要的内容不推荐使用。而且性能优化需要先确定性能指标，没有性能指标，你怎么评估优化效果。

很多性能优化手段都是提升某个指标，但可能会降低另一个指标。比如SSR提升FCP，但对TTI可能是负作用。比如SPA，对TTI是负作用，但有利于CLS（视觉稳定性）和INP(交互稳定性)





当前端资源过大导致加载慢时，可以采用以下异步加载方案来改善性能：

1. 代码分割（Code splitting）：将代码拆分成多个较小的模块，并按需加载。可以使用工具如Webpack、Rollup等来实现代码分割。通过代码分割，可以将页面所需的关键代码片段与非关键代码分离，只在需要时再进行加载，从而加快初始加载速度。这样可以避免一次性加载整个文件。
2. 懒加载（Lazy loading）：延迟加载非关键资源，直到用户需要使用它们时再进行加载。例如，当用户滚动到可见区域或触发某个事件时，再加载图片、视频或其他组件。懒加载可以减少初始加载所需的资源量，提升页面的响应速度。可以使用库如Intersection Observer来实现懒加载。
3. 资源预加载（Resource preloading）：在页面加载过程中，预加载可能需要的资源，以提前获取并缓存这些资源。可以使用`<link rel="preload">`标签或通过JavaScript动态添加预加载请求，告诉浏览器预先下载某些资源。这样，在需要使用这些资源时，它们已经被缓存，可以更快地加载。
4. 资源按需加载（On-demand resource loading）：根据用户的实际需求，按需加载资源。例如，可以根据用户的操作或选择，动态加载额外的模块或数据。通过按需加载，可以避免不必要的资源加载，提高页面的加载速度和性能。
5. CDN（Content Delivery Network）：使用CDN来分发前端资源可以加快资源的加载速度。CDN将资源分布到全球各地的服务器节点，使用户可以从最接近他们的节点获取资源，减少网络延迟和传输时间。
6. 图片优化：图片通常是前端资源中占用最大的部分。使用适当的图片格式（如WebP、JPEG XR）和压缩算法来减小图片文件的大小，同时保持良好的视觉质量。可以使用工具如ImageOptim、Kraken.io等来自动化图片优化的过程。
7. 缓存机制：合理利用浏览器缓存机制，通过设置适当的缓存头信息（如Cache-Control、ETag等）来让浏览器缓存静态资源。这样，在用户再次访问页面时，可以从缓存中加载资源，减少网络请求。
8. GZIP压缩：启用服务器端的GZIP压缩，将前端资源（如CSS、JavaScript文件）在传输过程中进行压缩。这可以减小文件的传输大小，加快下载速度。
9. HTTP/2协议：使用HTTP/2协议来提供资源。HTTP/2支持多路复用，可以并行下载多个资源，从而加快资源的加载速度。                                                                                                                                                                                                                                                                                                                                                                                                                     
10. 资源合并和压缩：将多个CSS或JavaScript文件合并为一个文件，并使用压缩算法进行压缩。这样可以减少文件的数量和大小，减少网络请求的次数。
11. 服务端缓存和CDN缓存：使用服务端缓存或CDN缓存来缓存静态资源，减少服务器的负载压力，并提供更快的访问速度。

这些方案可以根据应用的具体需求和场景进行选择和组合。通过将资源划分为更小的模块、按需加载、预加载和使用CDN等技术手段，可以减小文件大小，提高页面的加载速度和用户体验。

















网页性能：网页加载速度以及对用户输入的响应速度



跳出率（Bounce Rate）和转化率（Conversion Rate）是两个关键的网站分析指标，用于评估网站的用户体验和业务目标达成情况。

1. 跳出率（Bounce Rate）：跳出率是指访问网站的用户在进入网站后只查看了单个页面并离开的比例。通常以百分比表示。跳出率高可能意味着用户对网站内容不感兴趣、导航不友好、加载速度慢或页面设计不吸引人等问题。较低的跳出率通常意味着用户更愿意在网站上浏览多个页面，表示用户对网站内容的吸引力和用户体验的好坏。
2. 转化率（Conversion Rate）：转化率是指完成特定目标的用户数量与访问网站的总用户数量之间的比例。这个特定目标可以是购买产品、填写表单、订阅通讯、下载文件等。转化率通常以百分比表示。高转化率表示网站成功地引导用户执行期望的行动，实现了预期的业务目标。转化率的提升可能需要优化网站内容、流程、设计和营销策略等。



## 与用户相关的性能指标

- **[首次内容绘制 (FCP)](https://web.dev/articles/fcp?hl=zh-cn)**：衡量从网页开始加载到网页任何部分呈现在屏幕上所用的时间。
- **[Largest Contentful Paint (LCP)](https://web.dev/articles/lcp?hl=zh-cn)**：衡量从网页开始加载到屏幕上渲染最大的文本块或图片元素所用的时间。
- **[首次输入延迟 (FID)](https://web.dev/articles/fid?hl=zh-cn)**：衡量从用户首次与您的网站互动（点击链接、点按按钮或使用由 JavaScript 提供支持的自定义控件）到浏览器实际能够响应该互动的时间。
- **[Interaction to Next Paint (INP)](https://web.dev/articles/inp?hl=zh-cn)**：衡量与网页进行每次点按、点击或键盘交互的延迟时间，并根据互动次数选择该网页最差的互动延迟时间（或接近最高延迟时间）作为单个代表性值，以描述网页的整体响应速度。
- **[可交互时间 (TTI)](https://web.dev/articles/tti?hl=zh-cn)**：衡量的是从网页开始加载到视觉呈现、其初始脚本（若有）已加载且能够快速可靠地响应用户输入的时间。
- **[总阻塞时间 (TBT)](https://web.dev/articles/tbt?hl=zh-cn)**：测量 FCP 和 TTI 之间的总时间，在此期间，主线程处于屏蔽状态的时间够长，足以阻止输入响应。
- **[Cumulative Layout Shift (CLS)](https://web.dev/articles/cls?hl=zh-cn)**：衡量从页面开始加载到其[生命周期状态](https://developer.chrome.com/blog/page-lifecycle-api/?hl=zh-cn)更改为隐藏之间发生的所有意外布局偏移的累计得分。
- **[首字节时间 (TTFB)](https://web.dev/articles/ttfb?hl=zh-cn)**：测量网络使用资源的第一个字节响应用户请求所需的时间。



反馈页面的卡顿情况：INP 交互到下一次渲染响应的时间，优化





